<!doctype html>
<html>
<head>
  <meta charset="utf8">
  <title>Musreact - mustache to react compiler</title>
  <link rel="stylesheet" href="codemirror/lib/codemirror.css">
  <script src="codemirror/lib/codemirror.js"></script>
  <script src="codemirror/mode/xml/xml.js"></script>
  <script src="codemirror/mode/javascript/javascript.js"></script>
  <script src="js/musreact.js"></script>
<style>
#code {
    width: 48%;
    float: left;
}
#result {
  width: 48%;
  float: right;
}

pre {
  background-color: #fee;
}
</style>
</head>

<body>
<pre id="errors"></pre>

<div id="code">
  <div id="template">
    <label>Type the text of your mureact template here:</label>
    <textarea>
<div>
  <h1>{{name}} loves musreact </h1>
  <p>
    List of technologies that allow to build UIs:
      <ul>
        {{# people}}
          <li>{{name}}</li>
        {{/people}}
        {{^ people}}
          <em>No one</em>
        {{/ people}}
      </ul>
  </p>
  <p>
    <label>Type text here, and update the data. It doesn't disappear<br/>
      {{#input}}
        <input type={{type}} onChange={{onChange}} />
      {{/input}}
    </label>
  </p>
</div>
</textarea>
</div>
</div>

<textarea id="result">
  
</textarea>

<script>
var tpl = CodeMirror.fromTextArea(document.querySelector("#template>textarea"), {
    lineNumbers: true,
    mode: "xml"
});
tpl.on("change", compile);
  
var result = CodeMirror.fromTextArea(document.querySelector("textarea#result"), {
    lineNumbers: true,
    mode: "javascript",
    readOnly: true
});

function error(txt) {
  document.querySelector("#errors").textContent = txt;
}

var reactComp;
function compile() {
  error("");
  var before = Date.now();
  try {
     reactComp = parser.parse(tpl.getValue().trim());
  } catch (e) {
    error(e);
    throw e;
  }
  console.log((Date.now()-before) + "ms to compile from mustache to react source");
  result.setValue(reactComp);
}

compile();
</script>
</body>
</html>
